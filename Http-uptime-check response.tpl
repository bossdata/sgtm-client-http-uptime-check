___INFO___

{
  "type": "CLIENT",
  "id": "cvt_temp_public_id",
  "categories": [
    "UTILITY"
  ],
  "__wm": "VGVtcGxhdGUtQXV0aG9yX0NhdGNoLWFsbC1DbGllbnQtU2ltby1BaGF2YQ\u003d\u003d",
  "version": 1,
  "securityGroups": [],
  "displayName": "Http-uptime-check response",
  "brand": {
    "id": "brand_dummy",
    "displayName": "",
    "thumbnail": "data:image/png;base64,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"
  },
  "description": "Use this Client listen to a path (e.g. /ping) and return an up signal (e.g. pong!)",
  "containerContexts": [
    "SERVER"
  ]
}


___TEMPLATE_PARAMETERS___

[
  {
    "type": "LABEL",
    "name": "info",
    "displayName": "Make sure you set the \u003cstrong\u003ePriority\u003c/strong\u003e higher than any other client you are using (e.g. \u003cstrong\u003e1000\u003c/strong\u003e) and set a unique listening path (e.g. \u003cstrong\u003e/ping\u003c/strong\u003e) to ensure this client doesn\u0027t claim a request that is not intended for monitoring."
  },
  {
    "type": "TEXT",
    "name": "listeningRequestPath",
    "displayName": "Listening Request Path",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "defaultValue": "/ping"
  },
  {
    "type": "TEXT",
    "name": "statusMessage",
    "displayName": "Status Message",
    "simpleValueType": true,
    "alwaysInSummary": true,
    "defaultValue": "pong!"
  }
]


___SANDBOXED_JS_FOR_SERVER___

const claimRequest = require('claimRequest');
const getRequestHeader = require('getRequestHeader');
const getRequestPath = require('getRequestPath');
const makeNumber = require('makeNumber');
const makeString = require('makeString');
const returnResponse = require('returnResponse');
const setResponseBody = require('setResponseBody');
const setResponseStatus = require('setResponseStatus');

if(getRequestPath() === data.listeningRequestPath)
{
  
  claimRequest();
  
  setResponseStatus(200);
  setResponseBody(data.statusMessage);

  returnResponse();

}
else 
{
  return;
}


___SERVER_PERMISSIONS___

[
  {
    "instance": {
      "key": {
        "publicId": "return_response",
        "versionId": "1"
      },
      "param": []
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "access_response",
        "versionId": "1"
      },
      "param": [
        {
          "key": "writeResponseAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "writeHeaderAccess",
          "value": {
            "type": 1,
            "string": "specific"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  },
  {
    "instance": {
      "key": {
        "publicId": "read_request",
        "versionId": "1"
      },
      "param": [
        {
          "key": "requestAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "headerAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        },
        {
          "key": "queryParameterAccess",
          "value": {
            "type": 1,
            "string": "any"
          }
        }
      ]
    },
    "clientAnnotations": {
      "isEditedByUser": true
    },
    "isRequired": true
  }
]


___TESTS___

scenarios: []
setup: "const mockData = {\n  statusCode: '404',\n  statusMessage: 'test',\n  allowedOrigins:\
  \ '*'\n};\n\nmock('getRequestHeader', header => {\n  if (header === 'origin') {\n\
  \    return 'https://allow.com';\n  } else { \n    fail('getRequestHeader() called\
  \ with something other than \"origin\".'); \n  }\n});\n\n\n  "


___NOTES___

Created on 28/10/2020, 13:00:18


